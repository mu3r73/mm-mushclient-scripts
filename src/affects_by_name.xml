<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Wednesday, August 24, 2011, 7:36 AM -->
<!-- MuClient version 4.73 -->

<!-- Plugin "affects_by_name" generated by Plugin Wizard -->

<muclient>

<plugin
   name="affects_by_name"
   author="Ruthgul"
   id="6010f6bda5ebf2210998613d"
   language="Lua"
   purpose="Subtitles affects. Not all of them. :x"
   date_written="2011-08-24 07:35:19"
   date_modified="2015-04-19 09:09:36"
   requires="4.71"
   version="1.0"
   >

<description trim="y">

<![CDATA[

.-------------------.
 | affects_by_name |
`-------------------'

- Adds names for most buffs/debuffs as they are resisted/land/deal damage on tick/are dispelled/wear off/etc.

- It doesn't show names for positive affects "landing" (eg, when you successfully cast shadow armor).

- It works passively.


** REQUIRES **

- Client setting: Game, Configure, Output > [x] Convert IAC EOR/GA to new line (must be checked).
- Game, Configure, MXP / Pueblo... > Use MXP / Pueblo: On command (or Yes - always).


** HELP NEEDED **

This plugin is missing most new stuff for classes I haven't played yet (witch, ranger, bard, etc.), and some older stuff for which I haven't been able to get strings yet.

If you find an affect that isn't included in this plugin, please send Ruthgul a tell, or a parchment (including the full string and what it does, if possible), and I'll update the plugin.


Author: Ruthgul


Latest version:
http://github.com/mu3r73/mm-mushclient-scripts

]]>

</description>

</plugin>



<!--  Variables  -->

<variables>

  <variable name="char_name">[a-zA-Z0-9 \-\,\.\']+</variable>

</variables>



<!--  Triggers  -->

<triggers>

<!-- special case: siphon, timepieces -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(@!char_name)( has siphoned the spell effect of|(|\'s) (the legendary timepiece \'(.+)\'|Redemption from the Darkness) glows brightly as it strips) \'(?P&lt;spell&gt;.+)\' (from|off of) (?P&lt;who&gt;.+)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_siphon_or_tpdispel("%&lt;who&gt;", "%&lt;spell&gt;", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)\, the Archon Hunter) focuses\, purging \'(?P&lt;spell&gt;.+)\' from (her|him)self with a roar\!$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_siphon_or_tpdispel("%&lt;who&gt;", "%&lt;spell&gt;", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(@!char_name)\, the Archon Hunter\'s magic goes haywire\, tearing \'(?P&lt;spell&gt;.+)\' from you\!$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_siphon_or_tpdispel("you", "%&lt;spell&gt;", "%0")
</send>
  </trigger>


<!-- aegis -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The aegis protecting (?P&lt;who&gt;.+) from harm crumbles\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>if ("%&lt;who&gt;" ~= "you") then
  show_other_stuff("%&lt;who&gt;", "AEGIS off", "%0")
else
  show_important_stuff("you", "AEGIS off", "%0")
end
</send>
  </trigger>


<!-- air invocation -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You gently settle back onto the ground."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "AIR INVOCATION off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) gently settles back onto the ground\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "AIR INVOCATION off", "%0")
</send>
  </trigger>


<!-- armor -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^(The hardened air around you dissipates|The magical armor revolving around you dissipates\, replaced by hardy tree bark)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "ARMOR off", "%0")
</send>
  </trigger>


<!-- ash invocation -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel a slight shock as the element of ash ceases to flow through you."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "ASH INVOCATION off", "%0")
</send>
  </trigger>


<!-- augment aura -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="A sparkling wave of amber flits past the corner of your vision, then is gone."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "AUGMENT AURA off", "%0")
</send>
  </trigger>


<!-- awaken -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The rush of adrenaline sustaining you tapers off. You feel a brief moment of exhaustion."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "AWAKEN off", "%0")
</send>
  </trigger>


<!-- bless -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You no longer feel blessed by the Powers."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "BLESS off", "%0")
</send>
  </trigger>


<!-- blindness -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^(A brilliant flare of white light erupts in front of|(A dense black|Black) smoke(| rises from nowhere and) swirls (in front of|about)) (?P&lt;who&gt;.+)(\'s eyes\, but (.+) shuts them just in time|\, but nothing else seems to happen)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "BLINDNESS resisted", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) totters suddenly\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "BLINDNESS resisted", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^(You have been blinded\!|A brilliant flare of white light erupts in front of your eyes\!|(.+)(\- |\.\.\.)you can\'t see a thing\!|You stagger suddenly\, struck blind by (.+)'s mind control\.)$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "BLINDNESS", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) (appears to be blinded\.|is blinded by the smoke\!|has been blinded\!|staggers suddenly(.+) by (.+) mind control\.)$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("%&lt;who&gt;", "BLINDNESS", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^(A brilliant flare of white light erupts in front of|(A dense black|Black) smoke(| rises from nowhere and) swirls in front of|a cloud of dust into) (?P&lt;who&gt;.+)('\s eyes\.|\'s eyes\!|\, obscuring (.+) vision\.)$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("%&lt;who&gt;", "BLINDNESS", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^(Light suddenly penetrates the haze clouding your vision\, and you can see again|Your vision returns)\!$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "BLINDNESS off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name))( suddenly looks more confident as the haze clouding (.+) vision is lifted| is no longer blinded|\'s eyebrows go crazy as (.+) sight returns|rubs the smoke from (.+) eyes\, regaining the ability to see)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("%&lt;who&gt;", "BLINDNESS off", "%0")
</send>
  </trigger>


<!-- blood dance - needs strings -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="Your coat of blood starts to coagulate."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "BLOOD DANCE off", "%0")
</send>
  </trigger>


<!-- bubble cluster - needs strings -->


<!-- camouflage -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="Anyone who might be paying attention would surely notice as your camouflage wears off."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "CAMOUFLAGE off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^You notice (?P&lt;who&gt;.+) emerge from your peripheral vision\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "CAMOUFLAGE off", "%0")
</send>
  </trigger>


<!-- change sex -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel different."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "CHANGE SEX", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) doesn\'t look like (him|her|it)self anymore\.\.\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "CHANGE SEX", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="Your body returns to its natural form."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "CHANGE SEX off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name))\'s body suddenly changes shape\, and an eldritch glimmer drifts off into the atmosphere\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "CHANGE SEX off", "%0")
</send>
  </trigger>


<!-- combat blink -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The bluish field at the edge of your vision dissipates."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "COMBAT BLINK off", "%0")
</send>
  </trigger>


<!-- concealment - needs strings -->

 <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The strange mist obscuring your belongings fades and vanishes."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "CONCEALMENT off", "%0")
</send>
  </trigger>


<!-- concentration - needs strings? -->


<!-- condemn - needs strings -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(@!char_name) condemns you and your armor\, casting you out\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "CONDEMN armor", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(@!char_name) condemns you and your magic\, casting you out\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "CONDEMN magic", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(You|(@!char_name)) condemn(|s) (?P&lt;who&gt;.+) and (his|her|its) armor\, casting (him|her|it) out\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "CONDEMN armor", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(You|(@!char_name)) condemn(|s) (?P&lt;who&gt;.+) and (his|her|its) magic\, casting (him|her|it) out\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "CONDEMN magic", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The condemnation wracking your conscience fades."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "CONDEMN off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The condemnation wracking (?P&lt;who&gt;.+)\'s conscience fades\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "CONDEMN off", "%0")
</send>
  </trigger>


<!-- confusion -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="Your head feels numb as the world around you seems to warp and distort."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_handicap_stuff("you", "CONFUSION", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) staggers and steps backwards\, shaking (his|her|its) head in confusion\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "CONFUSION", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^There is a low rumble of thunder as the space surrounding (?P&lt;who&gt;.+) warps and distorts\, as if in pain(.*?)$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "CONFUSION", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The warping and twisting of your vision slowly decreases, then stops."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "CONFUSION off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) no longer seems bewildered by (his|her|its) surroundings\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "CONFUSION off", "%0")
</send>
  </trigger>


<!-- curse -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) glows with a dark crimson aura that swiftly vanishes\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "CURSE resisted", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel a crushing weight throughout your entire being, and stagger slightly."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "CURSE or MALEDICTION", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) glows briefly with a dark crimson aura\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "CURSE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^(The curse afflicting you dissipates|You feel a great weight lifted from your shoulders)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "CURSE off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) looks less afflicted\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "CURSE off", "%0")
</send>
  </trigger>


<!-- deafen -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^((.+?)you are deafened\!|There is a low rumble of thunder as a tightly\-contained and directed energy shockwave blasts through the area\.)$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "DEAFEN", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) stumbles and shakes (.+) head\, as if in pain\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "DEAFEN", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You slowly realize that you are hearing sounds again."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "DEAFEN off", "%0")
</send>
  </trigger>


<!-- death grip -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="Your grip on your weapon loosens."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "DEATH GRIP off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name))\'s grip on (his|her|its) weapon loosens\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "DEATH GRIP off", "%0")
</send>
  </trigger>


<!-- delay reincarnation - needs strings -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The world turns blue as you are temporarily shrouded by a strange nimbus of energy."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "DELAY REINCARNATION", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel as if a great weight has been lifted from your soul."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "DELAY REINCARNATION off", "%0")
</send>
  </trigger>


<!-- desecrate armor - needs strings? -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(@!char_name) performs an unsightly ritual in front of you\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "DESECRATE ARMOR", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^You perform an unsightly ritual in front of (?P&lt;who&gt;.+)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "DESECRATE ARMOR", "%0")
</send>
  </trigger>


<!-- detect alignment -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You can no longer detect auras."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "DETECT ALIGNMENT off", "%0")
</send>
  </trigger>


<!-- detect illusion -->
<!--
*+* Goosebumps wash over you as the world starts to look a little bit more real.
-->
  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You have lost your ability to detect illusions."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "DETECT ILLUSION off", "%0")
</send>
  </trigger>


<!-- detect invisibility -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel different as your senses become less heightened."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "DETECT INVISIBILITY off", "%0")
</send>
  </trigger>


<!-- detect magic -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You can no longer detect magical auras."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "DETECT MAGIC off", "%0")
</send>
  </trigger>


<!-- disequilibriate - needs strings -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The room starts to spin as vertigo sets in, and the only constant in view is *'s face."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "DISEQUILIBRIATE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The room stops spinning about you."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "DISEQUILIBRIATE off", "%0")
</send>
  </trigger>


<!-- disjunction -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You stagger suddenly, and your vision turns amber for a moment."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "DISJUNCTION", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) staggers suddenly\, and is outlined by a faint amber glow\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "DISJUNCTION", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The amber tint afflicting your vision clears."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "DISJUNCTION off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) shakes (his|her|its) head as the disjunction affecting (him|her|it) fades away\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "DISJUNCTION off", "%0")
</send>
  </trigger>


<!-- dust invocation -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The dust cloud whirling about you thins and dissipates."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "DUST INVOCATION off", "%0")
</send>
  </trigger>


<!-- electrogenic growth - needs strings -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(@!char_name) coats you with a glob of mucus\, leaving you conductive but unharmed\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "ELECTROGENIC GROWTH", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(@!char_name) coats (?P&lt;who&gt;.+) with a glob of mucus\, leaving (him|her|it) conductive but unharmed\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "ELECTROGENIC GROWTH", "%0")
</send>
  </trigger>


<!-- elemental shield -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The rainbow aura surrounding (?P&lt;who&gt;.+) flickers and vanishes\.$"
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "ELEMENTAL SHIELD off", "%0")
</send>
  </trigger>


<!-- energy orb -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The electrical energy pulses and arcs throughout your body!"
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_critical_stuff("you", "ENERGY ORB", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The electrical energy pulses and arcs throughout (?P&lt;who&gt;.+)\'s body\!$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_critical_stuff("%&lt;who&gt;", "ENERGY ORB", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^Electrical energy pulses(| and arcs) through(|out) your body\!$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_critical_stuff("you", "ENERGY ORB tick", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^Electrical energy pulses(| and arcs) through(|out) (?P&lt;who&gt;.+)\'s body\!$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_critical_stuff("%&lt;who&gt;", "ENERGY ORB tick", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The electrical energy cracking through your body is grounded."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "ENERGY ORB off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The electrical energy cracking through (?P&lt;who&gt;.+)\'s body is grounded\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "ENERGY ORB off", "%0")
</send>
  </trigger>


<!-- enhanced strength -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="Your super strength has worn off."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "ENHANCED STRENGTH off", "%0")
</send>
  </trigger>


<!-- epiphany - needs strings -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="Your eyes burn with an inner fire as the knowledge of the ages floods into your mind."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "EPIPHANY", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="Your series of epiphanic revelations come to an end."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "EPIPHANY off", "%0")
</send>
  </trigger>


<!-- etheric pollution -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="Your connection to the twin moons' etheric energy has been disrupted!"
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_handicap_stuff("you", "ETHERIC POLLUTION", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name))\'s connection to the twin moons\' etheric energy has been disrupted\!$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_handicap_stuff("%&lt;who&gt;", "ETHERIC POLLUTION", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel your connection to the twin moons return."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "ETHERIC POLLUTION off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) shines with the sudden return of energy from the twin moons\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_handicap_stuff("%&lt;who&gt;", "ETHERIC POLLUTION off", "%0")
</send>
  </trigger>


<!-- evil eye -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You stumble and almost fall, as you feel the evil power of *'s gaze affecting you."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "EVIL EYE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) stumbles and almost falls\, and a low gasp escapes from (.+)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "EVIL EYE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel better as the pervading feeling of doom leaves you."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "EVIL EYE off", "%0")
</send>
  </trigger>


<!-- excommunicate - needs strings -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(You|(@!char_name)) grab(|s) ahold of (?P&lt;who&gt;.+) and cast(|s) (him|her|it) out\!$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "EXCOMMUNICATE", "%0")
</send>
  </trigger>


<!-- extinction -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel a horrific, crushing weight press throughout your entire being."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_critical_stuff("you", "EXTINCTION", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) glows briefly with a maleficent citrine aura\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_critical_stuff("%&lt;who&gt;", "EXTINCTION", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^You turn pale(| and shudder) as dark magic burns away some of your life force\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_critical_stuff("you", "EXTINCTION tick", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) turns pale and shudders\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_critical_stuff("%&lt;who&gt;", "EXTINCTION tick", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel better as the lethal necromantic energy finally leaves your body."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "EXTINCTION off", "%0")
</send>
  </trigger>


<!-- faerie fire -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^You are (outlined by a faint pink glow|surrounded by a pink outline)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "FAERIE FIRE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) is (outlined by a faint pink glow|surrounded by a pink outline)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "FAERIE FIRE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The pink glow surrounding you fades away."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "FAERIE FIRE off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The pink glow surrounding (?P&lt;who&gt;.+) slowly fades away\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "FAERIE FIRE off", "%0")
</send>
  </trigger>


<!-- famine - doesn't appear on affects, just makes you hungry/thirsty - so, no wear off -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="*'s fingertips brush you, causing you to feel a sudden, strong pang of hunger."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "FAMINE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^Your fingertips brush (?P&lt;who&gt;.+), causing (.+) to gasp in shock\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "FAMINE", "%0")
</send>
  </trigger>


<!-- fatigue -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel lethargic, as if you need more sleep."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "FATIGUE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) is moving more lethargically\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "FATIGUE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel the unusual lethargy leaving your muscles."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "FATIGUE off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) seems refreshed as (his|her|its) focus returns\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "FATIGUE off", "%0")
</send>
  </trigger>


<!-- fire invocation -->
<!--
*+* You begin glowing with a flickering, orange-yellow aura.
-->
  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The elemental flames surrounding your body wisp into the ether\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_lethal_stuff("you", "FIRE INVOCATION off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The elemental flames surrounding (?P&lt;who&gt;.+)\'s body wisp into the ether\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_lethal_stuff("%&lt;who&gt;", "FIRE INVOCATION off", "%0")
</send>
  </trigger>


<!-- fireshield -->

  <trigger
   colour_change_type="1"
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="Your fireshield sputters and goes out."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "FIRESHIELD off", "%0")
</send>
  </trigger>

  <trigger
   colour_change_type="1"
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The shield of flames surrounding (?P&lt;who&gt;.+) sputters and goes out\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "FIRESHIELD off", "%0")
</send>
  </trigger>


<!-- flintstrike - needs strings -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You are covered with tinder."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "FLINTSTRIKE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) is coated with tinder\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "FLINTSTRIKE", "%0")
</send>
  </trigger>


<!-- force field -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The air particles around you return to normal density."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "FORCE FIELD off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The air around (?P&lt;who&gt;.+) becomes less dense\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "FORCE FIELD off", "%0")
</send>
  </trigger>


<!-- frost -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="A chill sinks deep into your bones."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "FROST", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) turns blue and shivers\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "FROST", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The frost covering you melts and you feel much warmer."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "FROST off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The frost covering (?P&lt;who&gt;.+) thaws\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "FROST off", "%0")
</send>
  </trigger>


<!-- fungal growth - needs strings -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The fungus leeches into your skin."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "FUNGAL GROWTH", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The fungus leeches into (?P&lt;who&gt;.+)\'s skin\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "FUNGAL GROWTH", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^Your body finally eradicates the infectious organisms coursing through it\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "FUNGAL GROWTH off", "%0")
</send>
  </trigger>


<!-- glamour -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The glamour wears off and your appearance reverts to normal."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "GLAMOUR off", "%0")
</send>
  </trigger>


<!-- glare of the crocodile - needs strings -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You slink into a lower profile, anxious beneath *'s cruel eye."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "GLARE OF THE CROCODILE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The unnerving feeling of someone watching you disappears."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "GLARE OF THE CROCODILE off", "%0")
</send>
  </trigger>


<!-- guise of nature - needs strings -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="Your body slumps into its natural form as your woodform reverts to flesh."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "GUISE OF NATURE off", "%0")
</send>
  </trigger>


<!-- haste -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel your movements slow to normal."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "HASTE off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) is no longer moving quickly\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "HASTE off", "%0")
</send>
  </trigger>


<!-- herald bloodthirst -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^Shrieking mightily\, (?P&lt;who&gt;.+) heralds (his|her|its) own bloodthirstiness\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "HERALD BLOODTHIRST", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^You feel less bloodthirsty\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "HERALD BLOODTHIRST off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The crazed look in (?P&lt;who&gt;.+)\'s bloodshot eyes fades away\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "HERALD BLOODTHIRST off", "%0")
</send>
  </trigger>


<!-- hex -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) glows with an ominous crimson aura\, but it fades too quickly\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "HEX resisted", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel a stifling, powerful shock throughout your entire being, and stagger slightly."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "HEX or BINDING CURSE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) glows briefly with an ominous crimson aura\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "HEX", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^(The stifling feeling of oppression leaves your being|The oppression hex stifling you finally dissipates)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "HEX off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The hex placed upon (?P&lt;who&gt;.+) finally loses its hold\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "HEX off", "%0")
</send>
  </trigger>


<!-- hide -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You jiggle and move about, alerting anyone watching to your presence."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "HIDE off", "%0")
</send>
  </trigger>


<!-- ice invocation -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The ice covering your body finally cracks and melts."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "ICE INVOCATION off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The air around (?P&lt;who&gt;.+)'s seems clearer\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "ICE INVOCATION off", "%0")
</send>
  </trigger>


<!-- immobilize -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel as if your feet have grown roots, and can only move with great difficulty!"
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "IMMOBILIZE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) gasps as the power of your gaze affects (.+)\!$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "IMMOBILIZE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The weighted feeling in your feet greatly lessens."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "IMMOBILIZE off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name))\'s knees nearly buckle as (he|she|it) regains (his|her|its) balance\, no long immobilized\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "IMMOBILIZE off", "%0")
</send>
  </trigger>


<!-- immutable nimbus - needs strings -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The strange nimbus surrounding you seems to dissipate."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "IMMUTABLE NIMBUS off", "%0")
</send>
  </trigger>


<!-- impede movement -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel a sudden weight crushing down upon your every movement, making it more difficult to walk."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "IMPEDE MOVEMENT", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) stumbles and staggers under the additional weight (.+) bestowed upon (.+)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "IMPEDE MOVEMENT", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You no longer feel the crushing weight pressing down upon your every movement."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "IMPEDE MOVEMENT off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) staggers as (.+) legs start to function properly again\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "IMPEDE MOVEMENT off", "%0")
</send>
  </trigger>


<!-- induce aggression -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="Your field of vision changes slightly; it's as if you are seeing everything through a red-tinted haze."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "INDUCE AGGRESSION", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) changes (his|her|its) stance and suddenly seems quite a bit more aggressive\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "INDUCE AGGRESSION", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The reddish tint affecting your vision seems to fade."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "INDUCE AGGRESSION off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) seems to have adopted a less aggressive stance\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "INDUCE AGGRESSION off", "%0")
</send>
  </trigger>


<!-- infravision -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You can no longer detect the body heat of life forms in the dark."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "INFRAVISION off", "%0")
</send>
  </trigger>


<!-- insanity -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The voices in your head begin to taunt you wildly as your sanity slips away from you!"
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "INSANITY", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) flails (.+) arms about wildly\, and gibbers\, shrieking about voices in (.+) head\!$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "INSANITY", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The voices babbling in your head subside; you regain a sense of your surroundings."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "INSANITY off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name))\'s eyes look less vacant as the shrieking voices in (.+) head recede\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "INSANITY off", "%0")
</send>
  </trigger>


<!-- inspirational hymn -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You sing the praises of the hymn and feel inspired."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "INSPIRATIONAL HYMN", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name))\'s ears perk up as (he|she|it) hears the word of the hymn\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "INSPIRATIONAL HYMN", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The feeling on inspiration leaves you as you stop humming."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "INSPIRATIONAL HYMN off", "%0")
</send>
  </trigger>


<!-- invisibility -->
<!--
*+* You dissolve into nothingness.
-->
  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^You (fade back into sight|shimmer and reappear|are now visible to the naked eye again|fade into existence)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "INVISIBILITY off", "%0")
</send>
  </trigger>


<!-- jinx -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) glows with a malevolent mauve aura\, but it fades too quickly\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "JINX resisted", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel a shocking, unexpected weight throughout your entire being, and stagger slightly."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "JINX", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) glows briefly with a malevolent mauve aura\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "JINX", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel as if a great weight has been lifted from your spirit."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "JINX off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) appears less burdened by misfortune\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "JINX off", "%0")
</send>
  </trigger>


<!-- lava cloak -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="As the lava cloak bound to your flesh extinguishes, your skin softens."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "LAVA CLOAK off", "%0")
</send>
  </trigger>


<!-- lava walk -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The protective clumps of smoldering lava on your feet solidify and crumble off."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "LAVA WALK off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The protective clumps of smoldering lava on (?P&lt;who&gt;.+)\'s feet solidify and crumble off\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "LAVA WALK off", "%0")
</send>
  </trigger>


<!-- leech conduit - needs strings -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The vampiric conduit wavering from (?P&lt;who&gt;.+)\'s chest dissipates\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "LEECH CONDUIT off", "%0")
</send>
  </trigger>


<!-- levitation -->
<!--
*+* Your feet rise a few inches off the ground.
*+* Your feet rise off the ground. (float)
-->
  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You slowly settle back to the ground."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "LEVITATION off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;.(@!char_name)) slowly settles back to the ground\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "LEVITATION off", "%0")
</send>
  </trigger>


<!-- lightning invocation -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="There is a faint blue spark as the electricity speeding you up is discharged."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "LIGHTNING INVOCATION off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The lightning speeding up (?P&lt;who&gt;.+) discharges to the ground\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "LIGHTNING INVOCATION off", "%0")
</send>
  </trigger>


<!-- lightning shroud -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The prismatic shroud of lightning surrounding (?P&lt;who&gt;.+) surges\, then discharges harmlessly to the ground\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "LIGHTNING SHROUD off", "%0")
</send>
  </trigger>


<!-- magma invocation -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The flames surrounding (?P&lt;who&gt;.+) flicker and vanish\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "MAGMA INVOCATION off", "%0")
</send>
  </trigger>


<!-- malediction -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) glows with a malevolent fuchsia aura\, but it fades quickly\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "MALEDICTION resisted", "%0")
</send>
  </trigger>

<!-- for malediction landing on self, see curse -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) glows briefly with a malevolent fuchsia aura\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "MALEDICTION", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel a great weight lift from your spirit."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "MALEDICTION off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^Malevolent energy rises from (?P&lt;who&gt;.+) and slowly dissipate(.*?)$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "MALEDICTION off", "%0")
</send>
  </trigger>


<!-- malignancy -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^A sickly glow surges around (?P&lt;who&gt;.+) only to fade out of existence just as quick\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "MALIGNANCY resisted", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You are outlined with an sickly green glow, briefly."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "MALIGNANCY", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) is outlined with a sickly green glow\, briefly\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "MALIGNANCY", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="A sickly green glow flits past the corner of your vision, then fades."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "MALIGNANCY off", "%0")
</send>
  </trigger>


<!-- memory drain -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You stagger and step back a foot as you sense a foreign presence attempting to enter your mind."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "MEMORY DRAIN", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^You extend your senses into the astral plane\, working on (?P&lt;who&gt;.+)\'s memories\.\.\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "MEMORY DRAIN", "%0")
</send>
  </trigger>


<!-- mental clarity - needs strings? -->


<!-- mental disruption - needs strings -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="(?P&lt;who&gt;(@!char_name)) staggers suddenly."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "MENTAL DISRUPTION resisted", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) staggers suddenly as (his|her|its) mind is disrupted by your mental power\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_handicap_stuff("%&lt;who&gt;", "MENTAL DISRUPTION", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The heavy weight pressing down on your mind seems to be suddenly released."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "MENTAL DISRUPTION off", "%0")
</send>
  </trigger>


<!-- mimic -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^(You revert back to your normal form\.|You struggle to hold your form\, but you eventually revert to your original shape\.)$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "MIMIC off", "%0")
</send>
  </trigger>


<!-- mind shield -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The image of the brick wall fades from your mind."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "MIND SHIELD off", "%0")
</send>
  </trigger>


<!-- mutilate -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^A patina of caustic acid washes over (?P&lt;who&gt;.+) before melting away (.+) skin\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "MUTILATE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The hideous scars covering your face spontaneously heal themselves."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "MUTILATE off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The hideous scars covering (?P&lt;who&gt;.+)'s face spontaneously heal themselves\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "MUTILATE off", "%0")
</send>
  </trigger>


<!-- necromancers guile -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel slightly more sinister."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "NECROMANCERS GUILE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The peripheral of your vision seems to lighten a bit and you feel less nefarious."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "NECROMANCERS GUILE off", "%0")
</send>
  </trigger>


<!-- nightmares -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="Your tongue dries out, and you suddenly start to fear the notion of sleep."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "NIGHTMARES", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="Your eyelips start to droop and sleep seems rather appealing."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "NIGHTMARES off", "%0")
</send>
  </trigger>


<!-- one with the forest - needs strings -->


<!-- ooze invocation -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The ooze surrounding your body evaporates."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "OOZE INVOCATION off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The ooze surrounding (?P&lt;who&gt;.+)\'s form evaporates into the air\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "OOZE INVOCATION off", "%0")
</send>
  </trigger>


<!-- otolithic growth - needs strings -->

<trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The curious stone in your ear rattles out and away."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "OTOLITHIC GROWTH off", "%0")
</send>
  </trigger>


<!-- paralysis -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^(You feel strangely lethargic as an alien substance courses through your veins\.\.\.|You feel your head pounding as if it would burst\, and cannot move from your current position\!)$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_handicap_stuff("you", "PARALYSIS", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) staggers and steps back\, (clutching (his|her|its) head|seemingly winded)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_critical_stuff("%&lt;who&gt;", "PARALYSIS", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You can move again."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "PARALYSIS off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) looks less rigid\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "PARALYSIS off", "%0")
</send>
  </trigger>


<!-- pass door -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You are no longer translucent."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "PASS DOOR off", "%0")
</send>
  </trigger>


<!-- pentacle -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel the protection of the pentacle subsiding."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "PENTACLE off", "%0")
</send>
  </trigger>


<!-- pestilence -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The pestilential lesions tormenting you recede with time."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "PESTILENCE off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The pestilential lesions covering (?P&lt;who&gt;.+) recede with time\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("%&lt;who&gt;", "PESTILENCE off", "%0")
</send>
  </trigger>


<!-- phalanx -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You stand down from your phalanx position."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "PHALANX off", "%0")
</send>
  </trigger>


<!-- plague -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) seems to resist (.+) magical plague\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "PLAGUE resisted", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^(Ghastly looking sores start cropping up on your body (.+)\!|You cough and choke from the diseased gasses wafting through the air\.)$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "PLAGUE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^(Ghastly looking sores|More sores) start cropping up on (?P&lt;who&gt;.+)\'s body (.+)\!$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "PLAGUE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) gasps as (.+) inhales some of the disease-ridden vapor\!$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "PLAGUE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^(The plague sores tormenting you suddenly vanish|You feel relieved as the (disease|plague) is burned from your body|You feel relieved as your (disease|plague) is cured)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "PLAGUE off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The sores covering (?P&lt;who&gt;.+) suddenly vanish\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("%&lt;who&gt;", "PLAGUE off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) looks relieved as (.+) (disease|plague) is (cured|burned from (.+) body)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("%&lt;who&gt;", "PLAGUE off", "%0")
</send>
  </trigger>


<!-- plodding fugue -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel exhausted and haggard, all the worse for wear."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "PLODDING FUGUE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) suddenly looks worn out and exhausted\, as though by a drudging slog\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "PLODDING FUGUE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel a bit more spring in your walk, a bit more pep in your step."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "PLODDING FUGUE off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) seems to perk up a bit\, dancing a merry little jig\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "PLODDING FUGUE off", "%0")
</send>
  </trigger>


<!-- poison -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^A noxious cloud of green gas swirls from (.+) fingertips to (?P&lt;who&gt;.+) for a moment\, but nothing else seems to happen\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "POISON resisted", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^(You choke and gag\.|You feel lethargic as an alien substance courses through your veins\.\.\.|You have been poisoned\!|You suddenly feel very ill\.|You cough and choke from the toxic gasses wafting through the air\.|You feel poison coursing through your veins\.)$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "POISON", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^A noxious cloud of green gas pours from (.+) fingertips\, swirling about (?P&lt;who&gt;.+)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>if ("%&lt;who&gt;" ~= "you") then
  show_important_stuff("%&lt;who&gt;", "POISON", "%0")
end
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) (looks very ill|appears to be poisoned|coughs and chokes from the toxic gasses wafting through the air)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("%&lt;who&gt;", "POISON", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^(The poison burning throughout your body seems to dissipate|You feel relieved as the poison is burned from your body|You peel some bark off a tree and use it to purge the poison from you|Your stomach has stopped churning)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "POISON off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) (appears to look much better|looks relieved as the poison is burned from (.+) body)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("%&lt;who&gt;", "POISON off", "%0")
</send>
  </trigger>


<!-- protection from evil -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel more vulnerable to evil forces."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "PROTECTION FROM EVIL off", "%0")
</send>
  </trigger>


<!-- protection from good -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel vulnerable to good forces again."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "PROTECTION FROM GOOD off", "%0")
</send>
  </trigger>


<!-- radiance invocation -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The violet light coloring everything fades from your vision."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "RADIANCE INVOCATION off", "%0")
</send>
  </trigger>


<!-- sanctuary -->
<!--
*+* You begin glowing with a bright light!
-->
  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The white aura surrounding (?P&lt;who&gt;.+) fades away\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_lethal_stuff("%&lt;who&gt;", "SANCTUARY off", "%0")
</send>
  </trigger>


<!-- sense life -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel less aware of your surroundings."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "SENSE LIFE off", "%0")
</send>
  </trigger>


<!-- sensory enhancement -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You no longer feel a tingling in your pineal gland."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "SENSORY ENHANCEMENT off", "%0")
</send>
  </trigger>


<!-- shadow armor -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The shadows protecting you seem to subside."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "SHADOW ARMOR off", "%0")
</send>
  </trigger>


<!-- shape shifting -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^(You begin to have difficulty retaining your altered shape\.\.|Your form reverts to normal)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "SHAPE SHIFTING off", "%0")
</send>
  </trigger>


<!-- shield -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="Your force shield dissipates."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "SHIELD off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name))\'s force shield dissipates\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "SHIELD off", "%0")
</send>
  </trigger>


<!-- silence -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You suddenly feel as if your mouth has been stuffed with cotton!"
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_handicap_stuff("you", "SILENCE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) (is now|has been) silenced\!$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("%&lt;who&gt;", "SILENCE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The feeling of cotton stuffing your mouth finally leaves you."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "SILENCE off", "%0")
</send>
  </trigger>


<!-- sleep -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel very sleepy... Zzzzzz..."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_handicap_stuff("you", "SLEEP", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel the magical pressure to remain asleep lift.*"
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "SLEEP off", "%0")
</send>
  </trigger>


<!-- slow ... needs to be separated from hinder, help required -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) seems to resist your enchantment\!$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "SLOW resisted", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel sluggish."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_handicap_stuff("you", "SLOW", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) is moving in slow motion\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "SLOW", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="(You no longer feel slower than honey pours in the winter|You shrug off your slug(|g)ishness\, feeling unhindered and renewed)\."
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "SLOW off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) (seems to be moving at a normal pace again|shrugs off (.+) slugishness)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("%&lt;who&gt;", "SLOW off", "%0")
</send>
  </trigger>


<!-- slow magic -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="A strange streaking haze overtakes your vision as everything around you appears to be moving slightly slower."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_handicap_stuff("you", "SLOW MAGIC", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^You create a very small temporospatial claudication directly around (?P&lt;who&gt;.+)'s body, and (.+) time field becomes slightly out of sync with everyone else\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "SLOW MAGIC", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) appears to be moving much slower\, creating an odd rippling effect in the air around (.+)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "SLOW MAGIC", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel a startling pulling sensation as you are jerked back into normal time."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "SLOW MAGIC off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The rippling effect in the space about (?P&lt;who&gt;.+) seems to dissipate\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "SLOW MAGIC off", "%0")
</send>
  </trigger>


<!-- smoke invocation -->
<!--
*+* Smoke billows about you from nowhere, distracting the eyes and minds of others.
-->
  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^You(| slowly) fade back into existence\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "SMOKE INVOCATION off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^(?P&lt;who&gt;(@!char_name)) fades into existence\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "SMOKE INVOCATION off", "%0")
</send>
  </trigger>


<!-- sneaking -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You no longer feel stealthy."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "SNEAKING off", "%0")
</send>
  </trigger>


<!-- soothing nocturne - needs strings -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) falters momentarily\, as though distracted by the soothing song$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "SOOTHING NOCTURNE resisted", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel overwhelmed by the beauty of the nocturne."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "SOOTHING NOCTURNE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) falters\, distracted by the beauty of the nocturne\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "SOOTHING NOCTURNE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="Shaking the lazy off, you feel energetic and aspirational."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "SOOTHING NOCTURNE off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^Catching a lucky break\, (?P&lt;who&gt;.+) trips over a crack and is startled out of the nocturne\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "SOOTHING NOCTURNE off", "%0")
</send>
  </trigger>


<!-- spell shield -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The shimmering bands of light surrounding (?P&lt;who&gt;.+) fade and vanish\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "SPELL SHIELD off", "%0")
</send>
  </trigger>


<!-- stone curse -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You can no longer do anything but think - your body has been turned into stone."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_handicap_stuff("you", "STONE CURSE", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The curse of stone wears off suddenly, and you find you can move again as your body comes back to life."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "STONE CURSE off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The curse of stone affecting (?P&lt;who&gt;.+) wears off suddenly\, and (.+) begins to move again\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "STONE CURSE off", "%0")
</send>
  </trigger>


<!-- steam invocation -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You become more opaque as your steamy form solidifies."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "STEAM INVOCATION off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) becomes more opaque as (his|her|its) steamy form solidifies\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "STEAM INVOCATION off", "%0")
</send>
  </trigger>


<!-- stone skin -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="Your skin feels soft and pliable again."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "STONE SKIN off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name))\'s skin looks normal again\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "STONE SKIN off", "%0")
</send>
  </trigger>


<!-- telekinesis -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel a weight off your mind as it transfer to your shoulders."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "TELEKINESIS off", "%0")
</send>
  </trigger>


<!-- telekinetic shield -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The hardened shield of air dissipates."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "TELEKINETIC SHIELD off", "%0")
</send>
  </trigger>


<!-- underwater breathing -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="(You feel the magic enabling you to breathe underwater diminish\.|Anamor Grintooth\, heir apparent to Darksea seizes upon something magical you cannot quite detect\, and shreds it with his claws\.)"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "UNDERWATER BREATHING off", "%0")
</send>
  </trigger>


<!-- unnatural strength - needs strings -->


<!-- water invocation -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel warmer as the element of water ceases to flow through you."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "WATER INVOCATION off", "%0")
</send>
  </trigger>


<!-- weaken -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel as though your legs have turned to water! You stagger, barely able to walk."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "WEAKEN", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) shudders\, staggers\, and almost falls\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "WEAKEN", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You feel strong again."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "WEAKEN off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) appears to feel stronger\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "WEAKEN off", "%0")
</send>
  </trigger>


<!-- web - needs new mesmerize wear off strings -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) (dodges out of the way of your vines|manages to brush the spiders off him just in time)\!$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "WEB resisted", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^(You are enmeshed in thick webbing produced by the spiders\!|A thick\, meshy web falls from somewhere above you\, entangling you with sticky ropes\.|The ground cracks and splits\, and thick\, dark green vines sprout from the earth\, restraining you\!|(|You are entranced by (.+)\'s eyes\.\.\. )You feel as if your entire body is entangled by sticky webs\.)$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "WEB", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) (is enmeshed in thick webbing produced by the spiders\!|stares deeply into (.+) eyes\, seemingly unable to move\.)$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("%&lt;who&gt;", "WEB", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^(The ground cracks and splits\, and thick\, dark green vines sprout from the earth\, restraining|A thick\, meshy web falls from somewhere above) (?P&lt;who&gt;.+)(\!|\, entangling (him|her|it) with sticky ropes\.)$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("%&lt;who&gt;", "WEB", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^(You break free from the webs holding you in place\!|Your mind becomes less foggy and you now have control over your actions\.)$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "WEB off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="^The (vines|webs) (binding|wrapped around) (?P&lt;who&gt;.+) (dissolve|wither and loosen)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "WEB off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) (breaks free from the webs holding (.+) in place\!|can now move about freely again as the forces affecting (.+) subside\.)$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "WEB off", "%0")
</send>
  </trigger>


<!-- whirlwind -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="You stop moving as though empowered by a whirlwind."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_important_stuff("you", "WHIRLWIND off", "%0")
</send>
  </trigger>

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   expand_variables="y"
   match="^(?P&lt;who&gt;(@!char_name)) stops moving as though empowered by a whirlwind\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("%&lt;who&gt;", "WHIRLWIND off", "%0")
</send>
  </trigger>


<!-- wind walk - needs strings -->

  <trigger
   enabled="y"
   group="affects"
   keep_evaluating="y"
   match="The wind rushing through your body gradually slows, until its presence is gone."
   omit_from_output="y"
   send_to="14"
   sequence="100"
  >
  <send>show_other_stuff("you", "WIND WALK off", "%0")
</send>
  </trigger>

</triggers>



<!--  Aliases  -->

<aliases>

  <alias
   enabled="y"
   match="^clear events$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>clear_events()
</send>
  </alias>


<!--  Plugin help  -->

  <alias
   enabled="y"
   match="^affects\_by\_name(|( |\:)help)$"
   regexp="y"
   script="OnHelp"
  >
  </alias>

</aliases>



<!--  Scripts  -->

<script>

<![CDATA[

debug = false

require "wait"


-----------------
-- plugin stuff
-----------------

function OnPluginInstall()
  wait.make(function()
    Tell("-- " .. GetPluginInfo(GetPluginID(), 1) .. ": type ")
    ColourTell("silver", "black", GetPluginInfo(GetPluginID(), 1) .. " help")
    Note(" to see info about this plugin --")

    -- give the plugins time to initialize
    wait.time(3)
    detect_plugins()
  end)
end


function OnPluginListChanged()
  detect_plugins()
end


function detect_plugins()
  use_sapi = sapi_plugin_present()
  reader_present = reader_plugin_present()
end


function is_plugin_present(name, id)
  local res = false

  local plugin_name = GetPluginInfo(id, 1)

  if (plugin_name == name) then
    -- is it enabled?
    if (GetPluginInfo(id, 17)) then
      res = true
    end
  end

  return res
end


function OnHelp()
  ColourNote("silver", "black", world.GetPluginInfo(world.GetPluginID(), 3))
  Note("")
  ColourNote("silver", "black", "(this version: " .. os.date("%c", GetPluginInfo(GetPluginID(), 14)) .. ")")
end


function plugin_update_url()
  local t = {
    "https://raw.githubusercontent.com/mu3r73/mm-mushclient-scripts/master/src/affects_by_name.xml",
  }
  return (table.concat(t, ";"))
end



------------
-- general
------------

function show_affect(who, fgcolor, bgcolor, subtitle, line)
  if (not reader_present) then
    -- if MushReader isn't present, show subtitles + the affects line
    if (string.lower(who) ~= "you") then
      ColourTell("whitesmoke", "black", who .. ": ")
    end

    ColourTell(fgcolor, bgcolor, subtitle)
    ColourTell("darkgray", "black", " > ")
    ColourNote("silver", "black", line)

  else
    -- if MushReader is present, SAPI say the subtitles
    local txt = ""
    if (string.lower(who) ~= "you") then
      txt = who .. ": "
    end
    txt = txt .. subtitle

    if (who == "you") and (fgcolor == "white") and (bgcolor == "red") then
    -- lethal stuff, so we need to inform immediately
      local res = sapi_interrupt(txt)

      if (res ~= 0) then
      -- speak_interrupt() not present in the plugin
        sapi_say(txt)
      end

    else
      sapi_say(txt)
    end
  end

  -- add to events mini, if it's present
  add_to_events_world(who, fgcolor, bgcolor, subtitle)

  -- broadcast the info, for events_mini and similar plugins
  local t = {
    [1] = who,
    [2] = fgcolor,
    [3] = bgcolor,
    [4] = subtitle,
  }
  BroadcastPlugin(1, table.concat(t, ";"))

  if (debug)
  and ((string.find(subtitle, "off"))
  or (string.find(subtitle, "tick"))) then
    AppendToNotepad("tick", "\r\n[" .. os.date("%H:%M:%S") .. "] " .. subtitle .. " ", "\r\n")
  end
end


function show_siphon_or_tpdispel(who, spell, line)
  if (spell == "sanctuary") then
    show_lethal_stuff(who, "SANCTUARY off", line)
  elseif ((spell == "aegis")
  or (spell == "air invocation")
  or (spell == "armor")
  or (spell == "ash invocation")
  or (spell == "combat blink")
  or (spell == "detect illusion")
  or (spell == "detect invisibility")
  or (spell == "dust invocation")
  or (spell == "haste")
  or (spell == "ice invocation")
  or (spell == "levitation")
  or (spell == "lightning invocation")
  or (spell == "ooze invocation")
  or (spell == "phalanx")
  or (spell == "radiance invocation")
  or (spell == "sense life")
  or (spell == "shape shifting")
  or (spell == "shield")
  or (spell == "stone skin")
  or (spell == "water invocation")) then
    show_important_stuff(who, string.upper(spell) .. " off", line)
  else
    show_other_stuff(who, string.upper(spell) .. " off", line)
  end
end



-----------------------
-- events world stuff
-----------------------

function add_to_events_world(who, fgcol, bgcol, subtitle)
  local events = GetWorld("events")
  -- gotta check every time in case they close it

  if (events) then
    if (string.lower(who) ~= "you") then
      events:ColourTell("silver", "black", who .. ": ")
    end

    --events:ColourNote(fgcol, bgcol, subtitle)
    events:ColourNote("silver", "black", subtitle)
  end
end


function clear_events()
  local events = GetWorld("events")
  if (events) then
    events:DeleteOutput()
    events:Pause(false)
  end
end



------------------------
-- sapi / reader stuff
------------------------

function sapi_say(text)
  local res

  if (use_sapi) then
    res = CallPlugin("463242566069ebfd1b379ec1", "say", text)
  end

  return res
end


function sapi_interrupt(text)
  local res

  if (use_sapi) then
    res = CallPlugin("463242566069ebfd1b379ec1", "speak_interrupt", text)
  end

  return res
end


function sapi_plugin_present()
  return is_plugin_present("Sapi_speaker", "463242566069ebfd1b379ec1") or is_plugin_present("Text_To_Speech", "463242566069ebfd1b379ec1")
end


function reader_plugin_present()
  return is_plugin_present("MushReader", "925cdd0331023d9f0b8f05a7")
end



--------------------------------
-- specific, by type of affect
--------------------------------

function show_other_stuff(who, subtitle, line)
  -- colors we'll use to show it
  local fgcolor = "blue"
  local bgcolor = "black"

  show_affect(who, fgcolor, bgcolor, subtitle, line)
end


function show_important_stuff(who, subtitle, line)
  -- an affect that I can/should do something about (re-cast, re-equip, cure, etc.)
  -- an affect that is ok to land on opponents (eg, blindness, poison), but is bad on form members

  -- colors we'll use to show it
  local fgcolor = "white"
  local bgcolor = "mediumblue"

  show_affect(who, fgcolor, bgcolor, subtitle, line)
end


function show_handicap_stuff(who, subtitle, line)
  -- an affect that disables me somehow (eg, silence, paralysis, sleep, slow), and there's nothing I can do about it

  -- colors we'll use to show it
  local fgcolor = "white"
  local bgcolor = "dimgray"

  show_affect(who, fgcolor, bgcolor, subtitle, line)
end


function show_critical_stuff(who, subtitle, line)
  -- an affect that needs full attention (eg, extinction, paralysis on form members, energy orb)

  -- colors we'll use to show it
  local fgcolor = "white"
  local bgcolor = "green"

  show_affect(who, fgcolor, bgcolor, subtitle, line)
end


function show_lethal_stuff(who, subtitle, line)
  -- an affect LOSS that can kill us if we don't take care of it (eg, sanctuary off!)

  -- colors we'll use to show it
  local fgcolor = "white"
  local bgcolor = "red"

  show_affect(who, fgcolor, bgcolor, subtitle, line)
end


]]>

</script>

</muclient>


<!--
add:

Dampening field:
A faint amber energy cloud forms around you, then fades.

Decrepify:
You start convulsing as Grisloir, the Archon Hunter's magic turns you wan and skeletal.

Irk:
An evil shaman blasts you with a horrible, loud song, enraging you.

Amnesia:
You feel a migraine coming on.

Damnation:
Venedikt, the Archon Hunter utters an oratory of fire and brimstone, damning you!

-->
